# ë¦¬ì•¡íŠ¸ì—ì„œì˜ ë¹„ë™ê¸° ì²˜ë¦¬

ë¦¬ì•¡íŠ¸ì—ì„œë„ ìë°”ìŠ¤í¬ë¦½íŠ¸ì™€ ë§ˆì°¬ê°€ì§€ë¡œ Promise, async/awaitëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ê¸°ë³¸ì ì¸ ë„êµ¬ì´ë‹¤. ë˜í•œ ì„œë²„ì™€ í†µì‹ ì„ ìœ„í•œ HTTP í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ Fetch ë˜ëŠ” axiosì™€ ê°™ì€ APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ë¦¬ì•¡íŠ¸ì—ì„œëŠ” ë¹„ë™ê¸° ì‘ì—…ì— ê´€ë ¨ëœ ë¡œì§ì„ ì»´í¬ë„ŒíŠ¸ì˜ ìƒëª… ì£¼ê¸° ë©”ì„œë“œ ì¤‘ í•˜ë‚˜ì¸ useEffect í•¨ìˆ˜ ì•ˆì— ë„£ì–´ì„œ ì²˜ë¦¬í•œë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨, ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ëœ í›„ì— ë¹„ë™ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³ , ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ì½”ë“œì˜ ê°€ë…ì„±ê³¼ ìœ ì§€ ë³´ìˆ˜ì„±ì„ ë†’ì´ê³ , ê°œë°œìê°€ ë¹„ë™ê¸° ì²˜ë¦¬ì™€ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ë³´ë‹¤ ì‰½ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì¤€ë‹¤. ì—¬ê¸°ì„œ ì¶”ê°€ë¡œ ì»¤ìŠ¤í…€ í›…ì„ ì‚¬ìš©í•œë‹¤ë©´ ë¹„ë™ê¸° ì²˜ë¦¬ ë¡œì§ì„ ì»´í¬ë„ŒíŠ¸ì™€ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•  ìˆ˜ ìˆì–´, ì½”ë“œê°€ ë”ìš± ê¹”ë”í•˜ê³  ëª¨ë“ˆí™”ëœ í˜•íƒœë¥¼ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.

ë˜í•œ SWRì„ í†µí•´ API ìš”ì²­ ê²°ê³¼ë¥¼ ìºì‹±í•˜ì—¬ ì¤‘ë³µ ìš”ì²­ì„ ë°©ì§€í•˜ê³ , React-Queryë¥¼ í†µí•´ ë°ì´í„° ìš”ì²­, ìºì‹±, ë¦¬í”„ë ˆì‹± ë“±ì„ ê°„í¸í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µë°›ì„ ìˆ˜ ìˆë‹¤.

## 1. ì»¤ìŠ¤í…€ í›…(Custom Hook)

ì»¤ìŠ¤í…€ í›…ì€ ë¦¬ì•¡íŠ¸ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¡œì§ì„ ì¬ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ ê¸°ëŠ¥ì´ë‹¤. í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë¡œì§ì„ ì¶”ì¶œí•˜ì—¬ ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ë§Œë“¤ë©´ ì½”ë“œë¥¼ ë”ìš± ê°„ê²°í•˜ê³  ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

ì»¤ìŠ¤í…€ í›…ì€ ë¦¬ì•¡íŠ¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë‹¤ë¥¸ í›…ë“¤ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ê·œì¹™ì— ë”°ë¼ì•¼ í•˜ëŠ”ë°, ì˜ˆë¥¼ ë“¤ë©´, ì»¤ìŠ¤í…€ í›…ì€ ë¦¬ì•¡íŠ¸ì˜ ê¸°ë³¸ í›…ì¸ useState, useEffect, useContext ë“±ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ í›… ì•ˆì—ì„œ, ë˜ëŠ” í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ì‚¬ìš©ë˜ì–´ì•¼ í•˜ê³ , ë‹¨ë…ìœ¼ë¡œ í•¨ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ëŠ” ì—†ë‹¤. ë˜í•œ ì»¤ìŠ¤í…€ í›…ì˜ ì´ë¦„ì€ "use"ë¡œ ì‹œì‘í•´ì•¼ í•˜ë©°, ì»¤ìŠ¤í…€ í›… ì•ˆì—ì„œëŠ” ì¡°ê±´ë¬¸, ë°˜ë³µë¬¸ ë“±ì˜ ì œì–´ë¬¸ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

```js
import { useState } from "react";

function useCustomHook() {
  const [count, setCount] = useState(0);

  const increment = () => {
    setCount((prevCount) => prevCount + 1);
  };

  return [count, increment];
}

const [count, increment] = useCustomHook(); // ì´ë ‡ê²Œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ !!
```

ê°™ì€ í›…ì„ ì‚¬ìš©í•˜ëŠ” ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ëŠ” ê°™ì€ ë³€ìˆ˜ ì´ë¦„ì„ ì‚¬ìš©í•´ë„ stateë¥¼ ê³µìœ í•˜ì§€ ì•ŠëŠ”ë‹¤. ì‚¬ìš©ì Hookì„ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ê·¸ ì•ˆì˜ stateì™€ effectëŠ” ì™„ì „íˆ ë…ë¦½ì ì´ë‹¤. ì»¤ìŠ¤í…€ í›…ì„ ì§ì ‘ì ìœ¼ë¡œ í˜¸ì¶œí•˜ê¸° ë•Œë¬¸ì— Reactì˜ ê´€ì ì—ì„œ ì´ ì»´í¬ë„ŒíŠ¸ëŠ” useState ë˜ëŠ” useEffectë¥¼ í˜¸ì¶œí•œ ê²ƒê³¼ ë‹¤ë¦„ì´ ì—†ë‹¤. í•˜ë‚˜ì˜ ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ useStateì™€ useEffectë¥¼ ì—¬ëŸ¬ ë²ˆ ë¶€ë¥¼ ìˆ˜ ìˆê³  ì´ë“¤ì€ ëª¨ë‘ ì™„ì „íˆ ë…ë¦½ì ì´ê¸° ë•Œë¬¸ì—, ì»¤ìŠ¤í…€ í›…ë„ ë§ˆì°¬ê°€ì§€ì´ë‹¤.

ì•„ë˜ì™€ ê°™ì´ í›…ì—ì„œ í›…ìœ¼ë¡œ ì •ë³´ë¥¼ ì „ë‹¬í•˜ê³  ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.

```js
const friendList = [
  { id: 1, name: "Phoebe" },
  { id: 2, name: "Rachel" },
  { id: 3, name: "Ross" },
];

function ChatRecipientPicker() {
  // useStateë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ˆê¸°ê°’ 1ë¡œ ì„¤ì •í•œ recipientID ìƒíƒœì™€, ì´ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” setRecipientID í•¨ìˆ˜ë¥¼ ìƒì„±í•œë‹¤.
  const [recipientID, setRecipientID] = useState(1);

  // useFriendStatus ì»¤ìŠ¤í…€í›…ì„ ì‚¬ìš©í•˜ì—¬, í˜„ì¬ recipientIDì˜ ì¹œêµ¬ ìƒíƒœë¥¼ ê°€ì ¸ì˜¨ë‹¤.
  // recipientIDê°€ ì—…ë°ì´íŠ¸ë˜ë©´ ë¦¬ë Œë”ë§ì´ ë°œìƒë˜ê¸° ë•Œë¬¸ì— useFriendStatus(recipientID)ë¥¼ í†µí•´ isRecipientOnlineë„ ì—…ë°ì´íŠ¸ëœë‹¤.
  const isRecipientOnline = useFriendStatus(recipientID);

  return (
    <>
      <Circle color={isRecipientOnline ? "green" : "red"} />
      {/* ì‚¬ìš©ìê°€ ì˜µì…˜ì„ ì„ íƒí•˜ë©´ setRecipientIDë¥¼ í˜¸ì¶œí•˜ì—¬ recipientIDë¥¼ ì—…ë°ì´íŠ¸í•œë‹¤. */}
      <select
        value={recipientID}
        onChange={(e) => setRecipientID(Number(e.target.value))}
      >
        {friendList.map((friend) => (
          <option key={friend.id} value={friend.id}>
            {friend.name}
          </option>
        ))}
      </select>
    </>
  );
}
```

API í˜¸ì¶œì„ ê°„í¸í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ê¸°ëŠ¥ì„ í•˜ëŠ” í›…ì´ ëŒ€í‘œì ì¸ ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ, í†µìƒ 'useFetch'ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤. ì•„ë˜ëŠ” Fetch í•¨ìˆ˜ë¥¼ ì´ìš©í•´ useFetch ì»¤ìŠ¤í…€ í›…ì„ ì‘ì„±í•œ ì˜ˆì‹œì´ë‹¤.

```js
import { useState, useEffect } from "react";

function useFetch(url) {
  // data, error, loading ìƒíƒœ ê°’ì„ useState Hookì„ ì‚¬ìš©í•˜ì—¬ ì •ì˜í•œë‹¤.
  const [data, setData] = useState(null);
  const [error, setError] = useState(null);
  const [loading, setLoading] = useState(true);

  // useEffect Hookì„ ì‚¬ìš©í•˜ì—¬, URL ê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ API í˜¸ì¶œì„ ìˆ˜í–‰í•˜ê³ , ê²°ê³¼ë¥¼ ìƒíƒœ ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•œë‹¤.
  useEffect(() => {
    // fetchData í•¨ìˆ˜ë¥¼ async í•¨ìˆ˜ë¡œ ì •ì˜í•œë‹¤.
    async function fetchData() {
      try {
        // fetch í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ URLì— ëŒ€í•œ API í˜¸ì¶œì„ ìˆ˜í–‰í•œë‹¤.
        const response = await fetch(url);
        // API í˜¸ì¶œ ê²°ê³¼ë¥¼ JSON í˜•íƒœë¡œ ë°˜í™˜í•œë‹¤.
        const json = await response.json();
        // JSON ë°ì´í„°ë¥¼ ìƒíƒœ ê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤.
        setData(json);
        // ë¡œë”© ìƒíƒœë¥¼ falseë¡œ ì„¤ì •í•œë‹¤.
        setLoading(false);
      } catch (error) {
        // ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´, ì—ëŸ¬ ê°ì²´ë¥¼ ìƒíƒœ ê°’ìœ¼ë¡œ ì„¤ì •í•˜ê³ , ë¡œë”© ìƒíƒœë¥¼ falseë¡œ ì„¤ì •í•œë‹¤.
        setError(error);
        setLoading(false);
      }
    }

    // fetchData í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.
    fetchData();
  }, [url]);

  // data, error, loading ìƒíƒœ ê°’ì„ ë°˜í™˜í•œë‹¤.
  return { data, error, loading };
}

export default useFetch;
```

## 2. SWR(useSWR)

SWRì€ React ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‚¬ìš©ë˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë°ì´í„° ë¡œë”© ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤. SWRì€ ë‹¤ë¥¸ ë°ì´í„° ë¡œë”© ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ë¹„êµí•˜ì—¬ ì„±ëŠ¥ì´ ìš°ìˆ˜í•˜ë©°, ì‚¬ìš©ì ê²½í—˜ì„ í–¥ìƒì‹œí‚¤ëŠ” ë§ì€ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

ë‹¨ìˆœíˆ useEffect ë‚´ë¶€ì— ë°ì´í„°ë¥¼ ìš”ì²­í•˜ëŠ” ì²˜ë¦¬ë¥¼ í•  ê²½ìš°, ìºì‹± ê¸°ëŠ¥ì´ ì œê³µë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ë§¤ë²ˆ ë°ì´í„°ë¥¼ ìƒˆë¡œ ìš”ì²­í•´ì•¼ í•˜ê³ , ë¡œë”© ì¤‘ì¸ì§€ ë¡œë“œ ì¤‘ì¸ì§€ ë˜ëŠ” ìš”ì²­ì´ ì„±ê³µí–ˆëŠ”ì§€ ì‹¤íŒ¨í–ˆëŠ”ì§€ ë“±ì˜ ìƒíƒœë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê´€ë¦¬í•´ì•¼ í•œë‹¤. ê·¸ëŸ¬ë‚˜ SWRì˜ useSWRì„ ì‚¬ìš©í•œë‹¤ë©´, ë‚´ë¶€ì ìœ¼ë¡œ ìºì‹±ì„ ì²˜ë¦¬í•˜ì—¬ ë™ì¼í•œ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ë²ˆ ìš”ì²­í•˜ì§€ ì•Šê³  ìºì‹œëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , ë‚´ë¶€ì ìœ¼ë¡œ ìƒíƒœë¥¼ ìë™ìœ¼ë¡œ ê´€ë¦¬í•˜ì—¬, ë¡œë”© ì¤‘ì¼ ë•Œì™€ ë°ì´í„° ë¡œë“œê°€ ì™„ë£Œëœ ê²½ìš°ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ê°„ë‹¨í•˜ê²Œ í•  ìˆ˜ ìˆë‹¤.

SWRë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì„¤ì¹˜ê°€ í•„ìš”í•˜ë‹¤.

```bash
npm install swr
```

ê·¸ë¦¬ê³  fetcher í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê³ , useSWRì„ importí•˜ì—¬ ì‚¬ìš©í•œë‹¤.

> **ğŸ“Œ useSWRì˜ ë§¤ê°œë³€ìˆ˜**
>
> - ì²« ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜: key  
>   : keyëŠ” SWRì´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì‹ë³„ìì´ë‹¤. ì£¼ë¡œ API ìš”ì²­ ì£¼ì†Œë‚˜ ë°ì´í„°ì˜ ê³ ìœ  IDë¥¼ ì‚¬ìš©í•œë‹¤.
>
> - ë‘ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜: fetcher (ì„ íƒì‚¬í•­)  
>   :fetcherëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ì´ë‹¤. ê¸°ë³¸ê°’ìœ¼ë¡œëŠ” fetch í•¨ìˆ˜ê°€ ì‚¬ìš©ëœë‹¤. fetch í•¨ìˆ˜ ëŒ€ì‹  ë‹¤ë¥¸ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë§Œì•½ fetcherë¥¼ ì§€ì •í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ SWRì€ keyë¥¼ ì§ì ‘ í˜¸ì¶œí•œë‹¤.

```js
import React, { useState } from "react";
import { Link, Outlet } from "react-router-dom";
import axios from "axios";
import useSWR from "swr";

export default function ReactPage() {
  const [number, setNumber] = useState(0);

  async function fetcher() {
    const result = await axios.get(
      "https://jsonplaceholder.typicode.com/posts"
    );
    console.log(result.data);

    return result.data;
  }

  const { data: docs, error } = useSWR("posts", fetcher);

  if (!docs) return <div>loading...</div>;
  if (error) return <div>failed to load</div>;

  return (
    <div>
      <button onClick={() => setNumber(number + 1)}>
        {/* ë¦¬ë Œë”ë§í•´ë„ API í˜¸ì¶œì´ ì´ë¤„ì§€ì§€ ì•ŠëŠ”ë‹¤. */}
        ë¦¬ë Œë”ë§ íšŸìˆ˜: {number}
      </button>
      {docs.map((doc) => (
        <Link
          to={`${doc.id}`}
          key={doc.id}
          style={{ display: "block", margin: "1rem 0" }}
        >
          {doc.title}
        </Link>
      ))}
      <Outlet />
    </div>
  );
}
```

## 3. React-Query(useQuery)

React ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ê´€ë¦¬í•˜ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤. ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì„œë²„ ë°ì´í„°ì˜ ìºì‹±, ìƒíƒœ ê´€ë¦¬, ì˜¤ë¥˜ ì²˜ë¦¬, ë¹„ë™ê¸° ë°ì´í„° ì—…ë°ì´íŠ¸ ë“±ì˜ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

<!-- 'ì „ì—­ ìƒíƒœ ê´€ë¦¬' í•™ìŠµ í›„ ì‘ì„± ! -->
